<!-- Header with background -->
<div class="header bg-gradient-danger py-7 py-lg-8">
  <div class="container">
    <div class="header-body text-center mb-7">
      <div class="row justify-content-center">
        <div class="col-lg-5 col-md-6">
          <h1 class="text-white">Change Password</h1>
          <p class="text-lead text-light">For security, you must change your temporary password before continuing.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="separator separator-bottom separator-skew zindex-100">
    <svg x="0" y="0" viewBox="0 0 2560 100" preserveAspectRatio="none" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <polygon class="fill-default" points="2560 0 2560 100 0 100"></polygon>
    </svg>
  </div>
</div>

<!-- Page content -->
<div class="container mt--8 pb-5">
  <div class="row justify-content-center">
    <div class="col-lg-6 col-md-8">
      <div class="card bg-secondary shadow border-0">
        <div class="card-body px-lg-5 py-lg-5">
          <div class="text-center text-muted mb-4">
            <small>Change your temporary password</small>
          </div>

          <!-- Important Notice -->
          <div class="alert alert-warning" role="alert">
            <span class="alert-inner--icon"><i class="fas fa-exclamation-triangle"></i></span>
            <span class="alert-inner--text">
              <strong>Attention!</strong> This is your first time in the system.
              You must create a new password to continue.
            </span>
          </div>

          <!-- Password Change Form -->
          <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()">

            <!-- Current Password -->
            <div class="form-group">
              <label class="form-control-label">
                Current Password <span class="text-danger">*</span>
              </label>
              <div class="input-group">
                <input
                  [type]="showCurrentPassword ? 'text' : 'password'"
                  class="form-control"
                  [class.is-invalid]="hasError('currentPassword')"
                  formControlName="currentPassword"
                  placeholder="Enter your temporary password">
                <div class="input-group-append">
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="togglePasswordVisibility('current')">
                    <i class="fas" [ngClass]="showCurrentPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="hasError('currentPassword')" class="invalid-feedback d-block">
                {{ getErrorMessage('currentPassword') }}
              </div>
            </div>

            <!-- New Password -->
            <div class="form-group">
              <label class="form-control-label">
                New Password <span class="text-danger">*</span>
              </label>
              <div class="input-group">
                <input
                  [type]="showNewPassword ? 'text' : 'password'"
                  class="form-control"
                  [class.is-invalid]="hasError('newPassword')"
                  formControlName="newPassword"
                  placeholder="Enter your new password">
                <div class="input-group-append">
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="togglePasswordVisibility('new')">
                    <i class="fas" [ngClass]="showNewPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="hasError('newPassword')" class="invalid-feedback d-block">
                {{ getErrorMessage('newPassword') }}
              </div>
            </div>

            <!-- Confirm Password -->
            <div class="form-group">
              <label class="form-control-label">
                Confirm New Password <span class="text-danger">*</span>
              </label>
              <div class="input-group">
                <input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  class="form-control"
                  [class.is-invalid]="hasError('confirmPassword')"
                  formControlName="confirmPassword"
                  placeholder="Confirm your new password">
                <div class="input-group-append">
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="togglePasswordVisibility('confirm')">
                    <i class="fas" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="hasError('confirmPassword')" class="invalid-feedback d-block">
                {{ getErrorMessage('confirmPassword') }}
              </div>
            </div>

            <!-- Submit Button -->
            <div class="text-center">
              <button
                type="submit"
                class="btn btn-primary btn-lg w-100"
                [disabled]="!passwordForm.valid || isSubmitting">
                <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm mr-2"></span>
                <i *ngIf="!isSubmitting" class="fas fa-key mr-2"></i>
                {{ isSubmitting ? 'Changing Password...' : 'Change Password' }}
              </button>
            </div>

          </form>

          <!-- Footer actions -->
          <div class="text-center mt-4">
            <small class="text-muted">
              Problems with your temporary password?
              <button
                type="button"
                class="btn btn-link btn-sm p-0"
                (click)="logout()">
                Click here to logout
              </button>
            </small>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>